# agent-permissions 背景（許可範囲の意図と例）

## [1. 作用範囲の定義](../rules/agent-permissions.mdc#作用範囲の定義)

- このルールでいう「プロジェクト内」は、固定の絶対パスではなく「その時に開いているワークスペース（リポジトリ）ルート配下」を指します。
- 目的は、複数のリポジトリ（例: `mkcoin` と `kabuweb`）を切り替えて作業しても、常に“いまのプロジェクト”を基準に判断できるようにすることです。

## [2. 無許可でOK_プロジェクト内の読み取り](../rules/agent-permissions.mdc#無許可でOK_プロジェクト内の読み取り)

- 読み取り（閲覧/検索/要約/差分確認）は基本的に安全で、作業の前提情報として必要なため無許可でOKにしています。
- 例: 仕様確認のための `README.md` の閲覧、`Grep` 相当の検索、差分の確認など。

## [3. 無許可でOK_プロジェクト内の作成と編集](../rules/agent-permissions.mdc#無許可でOK_プロジェクト内の作成と編集)

- プロジェクト内は編集まで無許可で許可します（ユーザーが「実装して」と言ったときに滞らないため）。
- ただし「大量変更」は意図の齟齬が起きやすいので、実行前に方針（何をどう置換するか、影響範囲）を短く説明します。

## [4. 無許可でOK_読み取り専用のGit確認](../rules/agent-permissions.mdc#無許可でOK_読み取り専用のGit確認)

- `git status` / `git diff` / `git log` は参照のみで、作業状況の把握に有用なので無許可でOKにしています。
- 例: 変更ファイルの確認、差分確認、直近コミットの確認。

## [5. 要許可_プロジェクト外への変更](../rules/agent-permissions.mdc#要許可_プロジェクト外への変更)

- プロジェクト外の変更は、意図しない場所の破壊や情報漏洩につながりやすいので必ず許可を取ります。
- 例: `C:\\Users\\...` 配下の別フォルダ、別リポジトリ、システム領域への書き込み。

## [6. 要許可_破壊的操作](../rules/agent-permissions.mdc#要許可_破壊的操作)

- 削除や履歴改変など、復元が難しい操作はプロジェクト内でも確認が必要です。
- 例: ファイル削除、`git reset --hard`、強制プッシュ相当の操作。

## [7. 要許可_依存関係と環境変更](../rules/agent-permissions.mdc#要許可_依存関係と環境変更)

- 依存関係追加/更新や環境変更は、再現性や他環境への影響が大きいので許可を取ります。
- 例: `pip install` の実行、`requirements.txt` 更新、エディタ/OS設定変更。

## [8. 要許可_ネットワーク通信と外部作用](../rules/agent-permissions.mdc#要許可_ネットワーク通信と外部作用)

- ネットワーク通信や外部サービスへの作用は、情報流出や課金・注文などのリスクがあるため許可を取ります。
- 例: 外部APIへのリクエスト、取引発注、外部サイトへのアクセス。
- Cursor 公式ドキュメント（https://docs.cursor.com）への参照用 fetch は、仕様確認のため無許可で行ってよいとする例外を設けている。

## [9. 要許可_Gitの書き込み操作](../rules/agent-permissions.mdc#要許可_Gitの書き込み操作)

- `commit`/`push` などは履歴や共有状態に影響するため、常に許可を取ります。
- 例: コミット作成、リモートへのプッシュ、タグ/リリース、PR作成。

## [10. 要許可_秘密情報の取り扱い](../rules/agent-permissions.mdc#要許可_秘密情報の取り扱い)

- 秘密情報は漏洩の影響が大きいので、保存やコミットは必ず許可を取ります。
- 例: `.env` 実ファイル作成、トークン/鍵の保存、秘密情報が含まれる可能性のあるファイルのコミット。

## [11. 不明点は要許可](../rules/agent-permissions.mdc#不明点は要許可)

- 境界が曖昧な場合は安全側に倒し、事前に確認してから実行します。
